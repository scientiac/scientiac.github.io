<!doctype html><html lang=en><head><meta charset=utf-8><script>(()=>{try{const a={light:`gruvbox-light`,dark:`night-solis`};const b=window.matchMedia(`(prefers-color-scheme: dark)`).matches;const c=localStorage.theme||(b?a.dark:a.light);document.documentElement.dataset.theme=c}catch(a){}})()</script><link href=/assets/css/themes.css rel=stylesheet><link href=/assets/css/readable.css rel=stylesheet><link href=/assets/css/global.css rel=stylesheet><link href=/assets/css/fonts.css rel=stylesheet><link href=/assets/css/logo.css rel=stylesheet><link href=https://scientiac.space/atom.xml rel=alternate title=RSS type=application/atom+xml><meta content=POSSE property=og:type><meta content=scientiac.space property=og:site_name><meta content=https://scientiac.space/res/thumbnail-light.png property=og:image><title>KL-OS: Process</title><meta content="KL-OS: Process" name=og:title><meta content="
Day 8 was about Process. Though, modern operating systems use the concept of threads to provide execution context. We treat processes like individual threads being run for our implementation.
First we define a structure for PCB (Process Control Block). We first define PROC_UNUSED and 0 and PROC_RUNNABLE as 1. Then we create a structure for a unit process with the following slots:

Process ID as an Integer.
State (PROC_UNUSED or PROC_RUNNABLE) as an Integer as defined before.
Stack Pointer as a vaddr_t (Virtual Address Type).
Kernel Stack as a list of unsigned 8bit Integers.

The Kernel Stack is essential for saving the registers while context switching.
Then, we defined the switch_context function that does the context switching. It takes
the previous and next stack pointer as arguments and then switches them during execution.
It saves the callee-saved registers into the stack, switches the stack pointer then restores the callee-saved registers from the stack. The execution context is saved as a temporary local variable on the stack.
Then, we work on process creation. The process creation function create_process takes
in the entry point of the process as a parameter and then returns the process struct.
The delay function is also created to act as a sleep style function which just does nop (Nothing) for 30000000 clock pulses.
Then a scheduler is made to make the context switching more autonomous.
A scheduler is basically a Kernel program which decides the next process.
Then, in the exception handler, we make it so that each process has it's own independent kernel stack. While switching, the contents of sscratch are switched too to resume the execution of process from where it was interrupted as if nothing had happened.
" name=description><meta content="
Day 8 was about Process. Though, modern operating systems use the concept of threads to provide execution context. We treat processes like individual threads being run for our implementation.
First we define a structure for PCB (Process Control Block). We first define PROC_UNUSED and 0 and PROC_RUNNABLE as 1. Then we create a structure for a unit process with the following slots:

Process ID as an Integer.
State (PROC_UNUSED or PROC_RUNNABLE) as an Integer as defined before.
Stack Pointer as a vaddr_t (Virtual Address Type).
Kernel Stack as a list of unsigned 8bit Integers.

The Kernel Stack is essential for saving the registers while context switching.
Then, we defined the switch_context function that does the context switching. It takes
the previous and next stack pointer as arguments and then switches them during execution.
It saves the callee-saved registers into the stack, switches the stack pointer then restores the callee-saved registers from the stack. The execution context is saved as a temporary local variable on the stack.
Then, we work on process creation. The process creation function create_process takes
in the entry point of the process as a parameter and then returns the process struct.
The delay function is also created to act as a sleep style function which just does nop (Nothing) for 30000000 clock pulses.
Then a scheduler is made to make the context switching more autonomous.
A scheduler is basically a Kernel program which decides the next process.
Then, in the exception handler, we make it so that each process has it's own independent kernel stack. While switching, the contents of sscratch are switched too to resume the execution of process from where it was interrupted as if nothing had happened.
" name=og:description><link rel="shortcut icon" href=/res/thumbnail.svg type=image/x-icon><meta content="width=device-width,initial-scale=1" name=viewport><meta content="rgb(253, 246, 227)" name=theme-color><script defer src=/assets/js/copy-button.js></script><link href=https://github.com/scientiac rel=me><link href=mailto:spandan@scientiac.space rel=me><link href=https://webmention.io/scientiac.space/webmention rel=webmention><meta content=@iac@polymaths.social name=fediverse:creator><body onload=updateThemeSelector();><div class=logo-container><a href=/> <div class=inner-logo-container></div> </a></div><nav data-style=classy><span><a href=/>Main</a></span><span><a href=/blog>Blog</a></span><span><a href=/syndications>Ping</a></span><span><a href=/more>More</a></span></nav><section class=section-body><div class=container><div id=html-content-holder><div class="h-entry syndicate-inside"><h2 class="p-name title syndicate-inside-title">KL-OS: Process</h2><div class=syndicate-pagedate><time class="dt-published dateandtag hidden" datetime=2025-12-29T00:00:00Z> 2025-12-29 </time><code class="dt-published dateandtag">2025-12-29</code><code class="u-category dateandtag">POSSE</code></div><a class="u-url hidden" href=https://scientiac.space/syndications/kl-os-2025-12-29/>https://scientiac.space/syndications/kl-os-2025-12-29/</a><div class="hidden p-author h-card"><a class=u-url href=https://scientiac.space rel=me> <img alt="Profile photo of scientiac" class=u-photo src=/res/thumbnail.png> <span class=p-name>scientiac</span> </a></div><div class="section syndicate-inside-text e-content"><a class=u-bridgy-fed hidden href=https://fed.brid.gy/></a><p><a href=https://codeberg.org/scientiac/KL-OS/src/branch/main/progress/day-8.md>Day 8</a> was about Process. Though, modern operating systems use the concept of threads to provide execution context. We treat processes like individual threads being run for our implementation.<p>First we define a structure for PCB (Process Control Block). We first define <code>PROC_UNUSED</code> and <code>0</code> and <code>PROC_RUNNABLE</code> as <code>1</code>. Then we create a structure for a unit process with the following slots:<ul><li>Process ID as an Integer.<li>State (<em><code>PROC_UNUSED </code>or <code>PROC_RUNNABLE</code></em>) as an Integer as defined before.<li>Stack Pointer as a <code>vaddr_t</code> (Virtual Address Type).<li>Kernel Stack as a list of unsigned <code>8bit</code> Integers.</ul><p>The Kernel Stack is essential for saving the registers while context switching.<p>Then, we defined the <code>switch_context</code> function that does the context switching. It takes the previous and next stack pointer as arguments and then switches them during execution. It saves the callee-saved registers into the stack, switches the stack pointer then restores the callee-saved registers from the stack. <em>The execution context is saved as a temporary local variable on the stack.</em><p>Then, we work on process creation. The process creation function <code>create_process</code> takes in the entry point of the process as a parameter and then returns the process struct.<p>The <code>delay</code> function is also created to act as a sleep style function which just does <code>nop</code> (Nothing) for 30000000 clock pulses.<p>Then a <strong>scheduler</strong> is made to make the context switching more autonomous. A scheduler is basically a Kernel program which decides the next process.<p>Then, in the exception handler, we make it so that each process has it's own independent kernel stack. While switching, the contents of <code>sscratch</code> are switched too to resume the execution of process from where it was interrupted as if nothing had happened.</div></div></div><div id=webmention><hr><h2>Webmentions</h2><form action=https://webmention.io/scientiac.space/webmention class=webmention-form method=post><div id=email-comment><p>Have you written a <a href=https://indieweb.org/responses>response</a> to this? Let me know the URL, Or, you can send your response via <a href="mailto:iac@scientiac.space?subject=Reply%3A%20KL-OS%3A%20Process">mail:</a><code>iac@scientiac.space</code></div><div class=send-webmention><input name=source type=url><button>Send Webmention</button></div><div><div class="ui message"></div></div><input name=target type=hidden value=https://scientiac.space/syndications/kl-os-2025-12-29/></form><div class=interaction-box></div></div></div><script defer src=/assets/js/themeSelector.js></script></section><div class=hidden><a href=https://polymaths.social/@iac rel=me>Fediverse</a></div><div class="hidden h-card"><img class="u-photo icon" alt=scientiac src=/res/thumbnail.png><a class="p-name u-url" href=https://scientiac.space rel=me>scientiac</a><p class=p-note>A Computer Engineering student who loves FOSS and is learning about privacy, the Internet and languages writing about the things he does.</div><footer><p class=codewithlove>I can't think of things to write on a footer. So, just <span class=main-background>imagine</span> something yourself.<p><a href=/series>Series</a> | <a href=/atom.xml>RSS</a> | <a href=https://github.com/scientiac/scientiac.github.io target=_blank>Source Code</a><p>All articles are usable under <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank>CC BY-SA 4.0</a>.</footer><ol id=themeSelector reversed></ol>